<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>MAY-Connect | Dashboard</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="styles.css">
</head>
<body>

<div class="page-header">
  <h2>Dashboard</h2>
  <button id="moreBtn" class="more-btn">More ⚙️</button>
</div>

<audio id="welcomeSound" src="sounds/welcome.mp3"></audio>

<!-- MORE PANEL -->
<div id="morePanel" class="more-panel hidden">
  <button onclick="openSetPin()">Set Transaction PIN</button>
  <button onclick="enableBiometric()">Enable Biometric</button>
  <button onclick="forgotPin()">Forgot PIN</button>
  <button onclick="forgotPassword()">Forgot Password</button>
  <button onclick="contactWhatsApp()">WhatsApp Support</button>
  <button onclick="callSupport()">Call Support</button>
  <button onclick="copyAccount()">Copy Account</button>
  <button onclick="logout()">Logout</button>
  <button onclick="closeMore()">Close</button>
</div>

<div class="dashboard-content">

  <div class="wallet-card">
    <p>Wallet Balance</p>
    <strong id="walletBalance">₦0</strong>
    <button onclick="copyAccount()">Copy Account Number</button>
  </div>

  <div class="quick-actions">
    <button onclick="location.href='data.html'">Buy Data</button>
    <button onclick="location.href='airtime.html'">Buy Airtime</button>
  </div>

  <div id="transactionsList" class="transactions-list"></div>
</div>

<script>
const backendUrl = "https://mayconnect-backend-1.onrender.com";

document.getElementById("moreBtn")
  .addEventListener("click",()=>morePanel.classList.toggle("hidden"));

function closeMore(){ morePanel.classList.add("hidden"); }
function openSetPin(){ alert("Set PIN"); }
function enableBiometric(){ alert("Biometric coming soon"); }
function forgotPin(){ alert("Forgot PIN"); }
function forgotPassword(){ alert("Forgot Password"); }
function contactWhatsApp(){ window.open("https://wa.me/2349011111111"); }
function callSupport(){ location.href="tel:+2349011111111"; }
function logout(){ localStorage.clear(); location.href="login.html"; }

function copyAccount(){
  const acc="1234567890";
  navigator.clipboard.writeText(acc);
  alert("Copied: "+acc);
}

document.addEventListener("DOMContentLoaded", async ()=>{
  welcomeSound.play();
  const token=localStorage.getItem("token");
  if(!token) return;

  const res=await fetch(`${backendUrl}/api/wallet`,{
    headers:{Authorization:`Bearer ${token}`}
  });
  const data=await res.json();
  walletBalance.textContent=`₦${data.balance||0}`;
});
</script>

</body>
</html>
