<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>MAY-Connect | Dashboard</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="styles.css">
</head>
<body>

<!-- LOGO + GREETING -->
<div class="logo-circle">
  <img src="images/logo.png" alt="MAY-Connect Logo">
</div>

<div style="text-align:center; margin-bottom:1rem;">
  <h3 id="greeting">Hello, User ğŸ‘‹</h3>
</div>

<audio id="welcomeSound" src="sounds/welcome.mp3"></audio>

<!-- MORE PANEL -->
<div id="morePanel" class="more-panel hidden">
  <button onclick="openSetPin()">Set Transaction PIN</button>
  <button onclick="enableBiometric()">Enable Biometric</button>
  <button onclick="forgotPin()">Forgot PIN</button>
  <button onclick="forgotPassword()">Forgot Password</button>
  <button onclick="contactWhatsApp()">WhatsApp Support</button>
  <button onclick="callSupport()">Call Support</button>
  <button onclick="copyAccount()">Copy Account</button>
  <button onclick="logout()">Logout</button>
  <button onclick="closeMore()">Close</button>
</div>

<div class="dashboard-content">

  <!-- WALLET -->
  <div class="wallet-card">
    <p>Wallet Balance</p>
    <strong id="walletBalance">â‚¦0</strong>
    <button onclick="copyAccount()">Copy Account Number</button>
  </div>

  <!-- QUICK ACTIONS -->
  <div class="quick-actions">
    <button onclick="location.href='data.html'">ğŸ“¶ Buy Data</button>
    <button onclick="location.href='airtime.html'">ğŸ“ Buy Airtime</button>
  </div>

  <div id="transactionsList" class="transactions-list"></div>
</div>

<!-- BOTTOM NAV -->
<div class="bottom-nav">
  <button onclick="location.href='dashboard.html'">ğŸ <br>Home</button>
  <button onclick="location.href='transactions.html'">ğŸ’³<br>Transactions</button>
  <button onclick="toggleMore()">âš™ï¸<br>More</button>
</div>

<script>
const backendUrl = "https://mayconnect-backend-1.onrender.com";

/* Bottom More Toggle */
function toggleMore(){
  document.getElementById("morePanel").classList.toggle("hidden");
}
function closeMore(){ morePanel.classList.add("hidden"); }

function openSetPin(){ alert("Set PIN"); }
function enableBiometric(){ alert("Biometric coming soon"); }
function forgotPin(){ alert("Forgot PIN"); }
function forgotPassword(){ alert("Forgot Password"); }
function contactWhatsApp(){ window.open("https://wa.me/2349011111111"); }
function callSupport(){ location.href="tel:+2349011111111"; }
function logout(){ localStorage.clear(); location.href="login.html"; }

function copyAccount(){
  const acc="1234567890";
  navigator.clipboard.writeText(acc);
  alert("Copied: "+acc);
}

document.addEventListener("DOMContentLoaded", async ()=>{
  welcomeSound.play();

  /* Username greeting */
  const name = localStorage.getItem("name") || "User";
  document.getElementById("greeting").textContent = `Hello, ${name} ğŸ‘‹`;

  const token=localStorage.getItem("token");
  if(!token) return;

  const res=await fetch(`${backendUrl}/api/wallet`,{
    headers:{Authorization:`Bearer ${token}`}
  });
  const data=await res.json();
  walletBalance.textContent=`â‚¦${data.balance||0}`;
});
</script>

</body>
</html>
